"0","percolate <- function(g, size, d) {"
"0","  "
"0","  giant = vector()"
"0","  "
"0","  # initial size of giant component"
"0","  c = components(g)"
"0","  giant[1] = max(c$csize)"
"0","  "
"0","  names(d) = 1:length(d)"
"0","  d = sort(d, decreasing=TRUE)"
"0","  vital = as.integer(names(d[1:size]))"
"0","  "
"0","  for (i in 1:size) {"
"0","    c = components(delete_vertices(g, vital[1:i]))"
"0","    giant[i+1] = max(c$csize)"
"0","  }"
"0","  return(giant)"
"0","}"
"0",""
"0","size <- vcount(g) / 2"
"0","percolate(g, size, d=degree(g))"
"1"," [1]"
"1"," 62"
"1"," 59"
"1"," 58"
"1"," 57"
"1"," 53"
"1"," 51"
"1"," 31"
"1"," 19"
"1"," 19"
"1"," 18"
"1"," 18"
"1"," 17"
"1"," 15"
"1"," 15"
"1"," 14"
"1"," 14"
"1","  6"
"1","  6"
"1","  6"
"1","  6"
"1","  6"
"1","  5"
"1","  5"
"1","  5"
"1","  5"
"1","  5"
"1","  4"
"1","  4"
"1","  3"
"1","  3"
"1","  3"
"1","  3"
"1","
"
