"0","efficency <- function(g){"
"0","  if (vcount(g) <= 1) return(0)"
"0","  efficency = 0"
"0","  paths <- shortest.paths(g, v=V(g), to=V(g))"
"0","  for (i in paths) {"
"0","    if (i != 0 && !is.infinite(i)) efficency = efficency + (1 / i)"
"0","  }"
"0","  return(efficency / (vcount(g) * (vcount(g) - 1)))"
"0","}"
"0",""
"0","efficency_remove <- function(g, node_names){"
"0","  g_copy = g"
"0","  g_colored = g"
"0","  V(g_colored)$color=""white"""
"0","  E(g_colored)$color=""green"""
"0","  steps=data.frame()"
"0","  steps=rbind(steps, list(name=""start"", efficency=efficency(g_copy)))"
"0","  i=0"
"0","  par(mfrow=c(2, 3), mar=c(0,0,0,0)+.5)"
"0","  for (node_name in node_names){"
"0","    g_copy = delete_vertices(g_copy, V(g_copy)[V(g_copy)$name==node_name])"
"0","    steps=rbind(steps, list(name=node_name, efficency=efficency(g_copy)))"
"0","    if(i<6) {"
"0","      V(g_colored)[V(g_colored)$name==node_name]$color=""red"" "
"0","      E(g_colored)[incident(g_colored, V(g_colored)$name==node_name)]$color = ""red"""
"0","      plot(g_colored, layout=layout, vertex.label=NA, vertex.size = 5, main=round(efficency(g_copy), digits=2))"
"0","      i=i+1"
"0","    }"
"0","  }"
"0","  return(steps)"
"0","}"
"0",""
