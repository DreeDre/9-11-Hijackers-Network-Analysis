"0","efficency <- function(g){"
"0","  if (vcount(g) <=  1) {"
"0","    return(0)"
"0","  }"
"0","  efficency = 0"
"0","  paths = distances(g, v = V(g), to = V(g))"
"0","  for (path in paths) {"
"0","    if (path !=  0 && !is.infinite(path)){"
"0","      efficency = efficency + (1 / path)"
"0","    }"
"0","  }"
"0","  return(efficency / (vcount(g) * (vcount(g) - 1)))"
"0","}"
"0",""
"0","efficency_remove <- function(g, node_names){"
"0","  g_copy = g"
"0","  # g_colored = g"
"0","  # V(g_colored)$color = ""white"""
"0","  # E(g_colored)$color = ""black"""
"0","  steps = data.frame()"
"0","  steps = rbind(steps, list(index = 1, name = ""start"", efficency = efficency(g_copy)))"
"0","  i = 2"
"0","  for (node_name in node_names){"
"0","    g_copy = delete_vertices(g_copy, V(g_copy)[V(g_copy)$name == node_name])"
"0","    steps = rbind(steps, list(index = i, name = node_name, efficency = efficency(g_copy)))"
"0","    i = i + 1"
"0","  #V(g_colored)[V(g_colored)$name == node_name]$color = ""red"""
"0","  #E(g_colored)[incident(g_colored, V(g_colored)$name == node_name)]$color = ""red"""
"0","  #plot(g_colored, layout = layout, vertex.label = NA, vertex.size = 5, main = round(efficency(g_copy), digits = 2))"
"0","  }"
"0","  return(steps)"
"0","}"
